
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Kitchen Echoes Recorder</title>
  <style>
    body { font-family: sans-serif; padding: 2em; background: #fefefe; }
    button { padding: 1em; margin: 1em 0; }
    input, textarea { width: 100%; margin-bottom: 1em; }
  </style>
</head>
<body>
  <h2>ğŸ¤ ç•™ä¸‹ä½ çš„å¨æˆ¿å£°éŸ³</h2>
  <p>ç‚¹å‡»å¼€å§‹å½•éŸ³ï¼Œè®²è¿°ä½ æƒ³åˆ†äº«çš„é¤å…è®°å¿†ã€‚</p>
  <button id="recordButton">å¼€å§‹å½•éŸ³</button>
  <button id="stopButton" disabled>åœæ­¢</button>
  <br>
  <form id="uploadForm">
    <input type="text" id="restaurant" placeholder="é¤å…å" required />
    <textarea id="description" placeholder="è¯·ç®€å•æè¿°è¿™æ®µå£°éŸ³çš„å†…å®¹" required></textarea>
    <input type="text" id="name" placeholder="ä½ çš„åå­—ï¼ˆå¯åŒ¿åï¼‰" />
    <p>âš ï¸ å½“å‰ç‰ˆæœ¬å½•éŸ³ä»…ä¿å­˜åˆ°æœ¬åœ°ã€‚å¦‚éœ€ä¸Šä¼ åˆ° Airtableï¼Œè¯·éƒ¨ç½²åˆ°æœåŠ¡å™¨ç«¯é…åˆè„šæœ¬ã€‚</p>
  </form>
  <p id="status"></p>

  <script>
    let mediaRecorder, audioChunks = [];

    const recordButton = document.getElementById("recordButton");
    const stopButton = document.getElementById("stopButton");
    const status = document.getElementById("status");

    recordButton.onclick = async () => {
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      mediaRecorder = new MediaRecorder(stream);
      mediaRecorder.start();
      audioChunks = [];

      mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
      mediaRecorder.onstop = () => {
        const blob = new Blob(audioChunks, { type: "audio/wav" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "kitchen_voice.wav";
        a.click();
        status.innerText = "âœ… å½•éŸ³å®Œæˆï¼Œå·²ä¿å­˜åˆ°æœ¬åœ°";
      };

      recordButton.disabled = true;
      stopButton.disabled = false;
      status.innerText = "ğŸ™ï¸ æ­£åœ¨å½•éŸ³...";
    };

    stopButton.onclick = () => {
      mediaRecorder.stop();
      recordButton.disabled = false;
      stopButton.disabled = true;
    };
  </script>
</body>
</html>
